<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agente de Vigilancia TecnolÃ³gica</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .step-container { display: none; margin-top: 20px; border-left: 4px solid #0d6efd; padding-left: 15px; }
        .active-step { display: block; animation: fadeIn 0.5s; }
        .loading-spinner { display: none; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="bg-light">

<div class="container py-5">
    <h1 class="mb-4 text-primary">ðŸ§¬ Agente de Vigilancia TecnolÃ³gica</h1>

    <!-- Estado Global -->
    <div class="alert alert-info" id="status-bar" style="display:none;">
        <strong>Estado:</strong> <span id="status-text">Esperando inicio...</span>
        <div class="spinner-border spinner-border-sm ms-2 loading-spinner" id="global-spinner" role="status"></div>
    </div>

    <!-- PASO 1: Ingesta -->
    <div class="card shadow-sm mb-4" id="step-1">
        <div class="card-header bg-white">1. Ingesta de Convocatoria</div>
        <div class="card-body">
            <label class="form-label">Pega aquÃ­ el texto o correo de la convocatoria:</label>
            <textarea class="form-control mb-3" id="inputText" rows="6" placeholder="Asunto: Convocatoria MinCiencias..."></textarea>
            <button class="btn btn-primary" onclick="startIngest()">ðŸš€ Analizar Convocatoria</button>
        </div>
    </div>

    <!-- PASO 2: Resultado Ingesta y Generar Ideas -->
    <div class="card shadow-sm mb-4 step-container" id="step-2">
        <div class="card-header bg-white">2. AnÃ¡lisis y GeneraciÃ³n de Ideas</div>
        <div class="card-body">
            <div id="ingest-results" class="mb-3 p-3 bg-body-tertiary rounded"></div>
            <button class="btn btn-success" onclick="generateIdeas()">ðŸ’¡ Generar Ideas de Proyecto</button>
        </div>
    </div>

    <!-- PASO 3: SelecciÃ³n de Ideas -->
    <div class="card shadow-sm mb-4 step-container" id="step-3">
        <div class="card-header bg-white">3. SelecciÃ³n de Idea</div>
        <div class="card-body">
            <p>Selecciona la mejor idea propuesta por la IA:</p>
            <div id="ideas-list" class="list-group mb-3"></div>
            <button class="btn btn-warning" onclick="selectIdea()">âœ… Confirmar SelecciÃ³n y Generar Esquema</button>
        </div>
    </div>

    <!-- PASO 4: FinalizaciÃ³n -->
    <div class="card shadow-sm mb-4 step-container" id="step-4">
        <div class="card-header bg-white">4. GeneraciÃ³n Final</div>
        <div class="card-body">
            <p>Esquema generado. Proceder a investigar y crear documentos finales.</p>
            <div id="schema-preview" class="mb-3 text-muted small"></div>
            <button class="btn btn-danger" onclick="finalizeProject()">ðŸ“„ Generar Documentos Finales</button>
        </div>
    </div>

    <!-- RESULTADOS FINALES -->
    <div class="card shadow-sm mb-4 step-container" id="step-5">
        <div class="card-header bg-success text-white">âœ… Proceso Completado</div>
        <div class="card-body">
            <h4>Documentos Generados:</h4>
            <ul id="final-docs-list" class="list-group">
                <!-- Links dinÃ¡micos aquÃ­ -->
            </ul>
        </div>
    </div>

</div>

<!-- LÃ³gica JS -->
<script src="/static/js/dashboard.js"></script>
</body>
</html>